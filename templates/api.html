<!-- templates/api.html -->

<div class="api-docs-container">


    <div class="stat-card" style="grid-column: 1 / -1;">
        <header class="title">
            ðŸ“š API Reference
            <p class="subtitle">REST API</p>
        </header>

    </div>

    <!-- System Metrics API -->
    <div class="stat-card api-endpoint">
        <div class="endpoint-header">
            <span class="http-method get">GET</span>
            <code class="endpoint-path">/api/metrics</code>
            <span class="tag">system</span>
        </div>
        <div class="endpoint-description">
            <p>Restituisce metriche complete del sistema in tempo reale.</p>
            <details>
                <summary>ðŸ“‹ Dettagli risposta</summary>
                <pre class="response-example">{
  "timestamp": "2024-01-20 10:30:45",
  "hostname": "server01",
  "memory": {
    "total_mb": 16384,
    "free_mb": 2048,
    "active_mb": 8192,
    "inactive_mb": 4096,
    "wired_mb": 1024,
    "cache_mb": 1024
  },
  "swap": {
    "total_mb": 4096,
    "used_mb": 512
  },
  "load": {
    "1min": 0.45,
    "5min": 0.62,
    "15min": 0.58
  },
  "os": {
    "type": "OpenBSD",
    "release": "7.4",
    "machine": "amd64"
  },
  "uptime": "5 days, 14:23:12",
  "disks": [...],
  "top_ports": [...],
  "network": [...],
  "top_cpu_processes": [...],
  "top_memory_processes": [...],
  "process_stats": {
    "total": 87,
    "running": 2,
    "sleeping": 85,
    "zombie": 0
  }
}</pre>
            </details>
        </div>
    </div>

    <!-- Man Pages Base API -->
    <div class="stat-card api-endpoint">
        <div class="endpoint-header">
            <span class="http-method get">GET</span>
            <code class="endpoint-path">/api/man/*</code>
            <span class="tag">man pages</span>
        </div>
        <div class="endpoint-description">
            <p>Handler base per tutte le API relative alle pagine man. Tutti gli endpoint sotto <code>/api/man/</code> sono gestiti da questo handler.</p>
        </div>
    </div>

    <!-- Man Sections -->
    <div class="stat-card api-endpoint">
        <div class="endpoint-header">
            <span class="http-method get">GET</span>
            <code class="endpoint-path">/api/man/sections</code>
            <span class="tag">man pages</span>
        </div>
        <div class="endpoint-description">
            <p>Restituisce l'elenco completo delle sezioni del manuale disponibili sul sistema.</p>
            <details>
                <summary>ðŸ“‹ Esempio risposta</summary>
                <pre class="response-example">{
  "sections": [
    {"number": "1", "name": "General Commands"},
    {"number": "2", "name": "System Calls"},
    {"number": "3", "name": "Library Functions"},
    {"number": "4", "name": "Devices and Device Drivers"},
    {"number": "5", "name": "File Formats"},
    {"number": "6", "name": "Games"},
    {"number": "7", "name": "Miscellaneous"},
    {"number": "8", "name": "System Management"},
    {"number": "9", "name": "Kernel Internals"}
  ]
}</pre>
            </details>
        </div>
    </div>

    <!-- Pages in Section -->
    <div class="stat-card api-endpoint">
        <div class="endpoint-header">
            <span class="http-method get">GET</span>
            <code class="endpoint-path">/api/man/{area}/{section}</code>
            <span class="tag">man pages</span>
        </div>
        <div class="endpoint-description">
            <p>Restituisce l'elenco delle pagine man in una specifica sezione.</p>
            <div class="param-list">
                <h4>Parametri URL:</h4>
                <ul>
                    <li><code>{area}</code> - L'area del manuale (es. "1", "2", "3", "5", "8" o path personalizzato)</li>
                    <li><code>{section}</code> - La sezione specifica all'interno dell'area</li>
                </ul>
            </div>
            <details>
                <summary>ðŸ“‹ Esempio richiesta</summary>
                <code class="example-request">GET /api/man/1/2</code>
                <p class="example-desc">Mostra tutte le pagine della sezione 1, area 2</p>
            </details>
        </div>
    </div>

    <!-- Page Metadata -->
    <div class="stat-card api-endpoint">
        <div class="endpoint-header">
            <span class="http-method get">GET</span>
            <code class="endpoint-path">/api/man/{area}/{section}/{name}</code>
            <span class="tag">man pages</span>
        </div>
        <div class="endpoint-description">
            <p>Restituisce i metadati di una specifica pagina man.</p>
            <div class="param-list">
                <h4>Parametri URL:</h4>
                <ul>
                    <li><code>{area}</code> - L'area del manuale</li>
                    <li><code>{section}</code> - La sezione</li>
                    <li><code>{name}</code> - Il nome della pagina man</li>
                </ul>
            </div>
            <details>
                <summary>ðŸ“‹ Esempio richiesta</summary>
                <code class="example-request">GET /api/man/1/1/ls</code>
                <p class="example-desc">Metadati della pagina man di 'ls' nella sezione 1</p>
            </details>
            <details>
                <summary>ðŸ“‹ Esempio risposta</summary>
                <pre class="response-example">{
  "name": "ls",
  "section": "1",
  "title": "list directory contents",
  "description": "The ls utility lists the contents of a directory...",
  "author": "The OpenBSD Project",
  "date": "March 31, 2022"
}</pre>
            </details>
        </div>
    </div>

    <!-- Search -->
    <div class="stat-card api-endpoint">
        <div class="endpoint-header">
            <span class="http-method get">GET</span>
            <code class="endpoint-path">/api/man/search</code>
            <span class="tag">man pages</span>
        </div>
        <div class="endpoint-description">
            <p>Cerca pagine man corrispondenti a una query di ricerca.</p>
            <div class="param-list">
                <h4>Parametri Query:</h4>
                <ul>
                    <li><code>q</code> - Il termine di ricerca (obbligatorio)</li>
                </ul>
            </div>
            <details>
                <summary>ðŸ“‹ Esempio richiesta</summary>
                <code class="example-request">GET /api/man/search?q=socket</code>
            </details>
            <details>
                <summary>ðŸ“‹ Esempio risposta</summary>
                <pre class="response-example">{
  "results": [
    {
      "name": "socket",
      "section": "2",
      "description": "create an endpoint for communication"
    },
    {
      "name": "socket",
      "section": "3",
      "description": "socket library functions"
    },
    {
      "name": "socketpair",
      "section": "2",
      "description": "create a pair of connected sockets"
    }
  ]
}</pre>
            </details>
        </div>
    </div>

    <!-- Note sul rendering -->
    <div class="stat-card api-endpoint">
        <div class="endpoint-header">
            <span class="http-method get">GET</span>
            <code class="endpoint-path">/man/{section}/{name}.{format}</code>
            <span class="tag">rendering</span>
        </div>
        <div class="endpoint-description">
            <p>Renderizza una pagina man in vari formati (non JSON, ma inclusa per completezza).</p>
            <div class="param-list">
                <h4>Formati supportati:</h4>
                <ul>
                    <li><code>.html</code> - Pagina HTML formattata</li>
                    <li><code>.pdf</code> - Documento PDF</li>
                    <li><code>.md</code> - Markdown</li>
                </ul>
            </div>
            <details>
                <summary>ðŸ“‹ Esempio richiesta</summary>
                <code class="example-request">GET /man/1/ls.html</code>
                <p class="example-desc">Renderizza la pagina man di 'ls' in formato HTML</p>
            </details>
        </div>
    </div>
</div>

<style>
/* Stili aggiuntivi per la documentazione API */
.api-docs-container {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(400px, 1fr));
    gap: 20px;
    padding: 20px;
}

.api-endpoint {
    transition: transform 0.2s;
}

.api-endpoint:hover {
    transform: translateY(-2px);
}

.endpoint-header {
    display: flex;
    align-items: center;
    gap: 12px;
    margin-bottom: 16px;
    flex-wrap: wrap;
}

.http-method {
    padding: 4px 12px;
    border-radius: 4px;
    font-weight: bold;
    font-size: 0.85rem;
    text-transform: uppercase;
    letter-spacing: 0.5px;
}

.http-method.get {
    background: rgba(59, 130, 246, 0.1);
    color: #3b82f6;
    border: 1px solid rgba(59, 130, 246, 0.2);
}

.endpoint-path {
    font-family: monospace;
    font-size: 1rem;
    font-weight: bold;
    color: var(--text);
    background: var(--bg-secondary);
    padding: 4px 8px;
    border-radius: 4px;
}

.endpoint-description {
    color: var(--text-muted);
    font-size: 0.9rem;
    line-height: 1.6;
}

.endpoint-description p {
    margin: 0 0 12px 0;
}

.param-list {
    background: var(--bg-secondary);
    padding: 12px;
    border-radius: 6px;
    margin: 12px 0;
    font-size: 0.85rem;
}

.param-list h4 {
    margin: 0 0 8px 0;
    color: var(--text);
    font-size: 0.9rem;
}

.param-list ul {
    margin: 0;
    padding-left: 20px;
}

.param-list li {
    margin-bottom: 4px;
}

.param-list code {
    background: var(--bg-primary);
    padding: 2px 6px;
    border-radius: 4px;
    font-family: monospace;
}

details {
    margin-top: 12px;
}

summary {
    color: var(--primary);
    cursor: pointer;
    font-size: 0.85rem;
    font-weight: 500;
}

summary:hover {
    text-decoration: underline;
}

.response-example {
    background: var(--bg-secondary);
    padding: 12px;
    border-radius: 6px;
    font-family: monospace;
    font-size: 0.8rem;
    overflow-x: auto;
    white-space: pre-wrap;
    word-wrap: break-word;
    margin-top: 8px;
}

.example-request {
    background: var(--bg-secondary);
    padding: 8px 12px;
    border-radius: 4px;
    font-family: monospace;
    font-size: 0.85rem;
    display: block;
    margin: 8px 0;
}

.example-desc {
    font-size: 0.8rem;
    color: var(--text-muted);
    margin-top: 4px;
}

.tag {
    background: var(--bg-secondary);
    color: var(--text-muted);
    padding: 2px 8px;
    border-radius: 12px;
    font-size: 0.7rem;
    font-weight: 500;
    letter-spacing: 0.3px;
}
</style>
